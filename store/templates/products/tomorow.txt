

from django.shortcuts import render
from .models import Brand, Product

def product_filter(request):
    brands = Brand.objects.all()
    products = Product.objects.all()
    return render(request, 'product_filter.html', {'brands': brands, 'products': products})



    from django.http import JsonResponse
from .models import Product

def fetch_products(request):
    selected_brand_ids = request.GET.getlist('brands[]')
    products = Product.objects.filter(brand__id__in=selected_brand_ids)
    # Perform any additional filtering or manipulation as needed

    # Return the filtered products in JSON format
    products_data = [{'name': product.name, 'price': product.price} for product in products]
    return JsonResponse(products_data, safe=False)


    from django.urls import path
from .views import product_filter, fetch_products

urlpatterns = [
    path('product-filter/', product_filter, name='product_filter'),
    path('fetch-products/', fetch_products, name='fetch_products'),
]


<h2>Brand Filter</h2>
  {% for brand in brands %}
    <input type="checkbox" class="brand-checkbox" value="{{ brand.id }}" id="brand{{ brand.id }}">
    <label for="brand{{ brand.id }}">{{ brand.name }}</label><br>
  {% endfor %}

  <h2>Products</h2>
  <div id="products-container">
    <!-- The filtered products will be dynamically populated here -->
  </div>

  <script>
    // Attach event listener to brand checkboxes
    $('.brand-checkbox').on('change', function() {
      fetchProducts();
    });

    function fetchProducts() {
      // Get the selected brand IDs
      const selectedBrands = $('.brand-checkbox:checked').map(function() {
        return this.value;
      }).get();

      // Make AJAX request to fetch products
      $.ajax({
        url: '/fetch-products/',
        type: 'GET',
        data: { brands: selectedBrands },
        dataType: 'json',
        success: function(response) {
          // Render the products in the container
          $('#products-container').empty();
          $.each(response, function(index, product) {
            const productElement = $('<div>').text(product.name + ' - ' + product.price);
            $('#products-container').append(productElement);
          });
        },
        error: function(xhr, status, error) {
          console.error(xhr.responseText);
        }
      });
    }
  </script>